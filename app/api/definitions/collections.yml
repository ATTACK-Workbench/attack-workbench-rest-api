components:
  schemas:
    collection:
      type: object
      required:
        - workspace
        - stix
      properties:
        workspace:
          $ref: '#/components/schemas/workspace-x-mitre-collection'
        stix:
          $ref: '#/components/schemas/stix-x-mitre-collection'

    workspace-x-mitre-collection:
      type: object
      required:
        - imported
      properties:
        imported:
          type: string
          format: date-time
        import_categories:
          type: object
          properties:
            additions:
              type: array
              items:
                type: string
            changes:
              type: array
              items:
                type: string
            minor_changes:
              type: array
              items:
                type: string
            revocations:
              type: array
              items:
                type: string
            deprecations:
              type: array
              items:
                type: string
            supercedes_user_edits:
              type: array
              items:
                type: string
            supercedes_collection_changes:
              type: array
              items:
                type: string

    stix-x-mitre-collection:
      allOf:
        - $ref: 'stix-common.yml#/components/schemas/stix-common'
        - type: object
          required:
            - name
          properties:
            # x-mitre-collection specific properties
            name:
              type: string
              example: 'Enterprise ATT&CK'
            description:
              type: string
            # ATT&CK custom properties
            x_mitre_contents:
              type: array
              items:
                $ref: '#/components/schemas/x_mitre_contents'
            x_mitre_deprecated:
              type: boolean
              example: false
            x_mitre_version:
              type: string
              example: '1.0'

    x_mitre_contents:
      type: object
      properties:
        object_ref:
          type: string
        object_modified:
          type: string
      required:
        - object_ref
        - object_modified
